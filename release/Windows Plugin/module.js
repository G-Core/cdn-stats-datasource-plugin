/* [create-plugin] version: 5.26.2 */
/* [create-plugin] plugin: gcorelabs-cdn-stats-datasource@2.0.0 */
define(["@grafana/ui","lodash","react","@grafana/data","@grafana/runtime"],(e,t,r,n,a)=>(()=>{var o={41:e=>{e.exports=function(e){return function(t){return e(t)}}},492:(e,t,r)=>{e=r.nmd(e);var n=r(1433),a=r(659),o=t&&!t.nodeType&&t,i=o&&e&&!e.nodeType&&e,s=i&&i.exports===o?n.Buffer:void 0,c=(s?s.isBuffer:void 0)||a;e.exports=c},659:e=>{e.exports=function(){return!1}},1163:(e,t,r)=>{var n=r(6204),a=r(1256),o=r(6397),i=r(492),s=r(2845),c=r(7995),l=Object.prototype.hasOwnProperty;e.exports=function(e,t){var r=o(e),u=!r&&a(e),p=!r&&!u&&i(e),b=!r&&!u&&!p&&c(e),f=r||u||p||b,y=f?n(e.length,String):[],g=y.length;for(var d in e)!t&&!l.call(e,d)||f&&("length"==d||p&&("offset"==d||"parent"==d)||b&&("buffer"==d||"byteLength"==d||"byteOffset"==d)||s(d,g))||y.push(d);return y}},1256:(e,t,r)=>{var n=r(9250),a=r(2934),o=Object.prototype,i=o.hasOwnProperty,s=o.propertyIsEnumerable,c=n(function(){return arguments}())?n:function(e){return a(e)&&i.call(e,"callee")&&!s.call(e,"callee")};e.exports=c},1433:(e,t,r)=>{var n=r(5380),a="object"==typeof self&&self&&self.Object===Object&&self,o=n||a||Function("return this")();e.exports=o},1485:e=>{var t=Function.prototype.toString;e.exports=function(e){if(null!=e){try{return t.call(e)}catch(e){}try{return e+""}catch(e){}}return""}},1491:(e,t,r)=>{var n=r(8953),a=r(7499),o=r(8201),i=Object.prototype.hasOwnProperty;e.exports=function(e){if(!n(e))return o(e);var t=a(e),r=[];for(var s in e)("constructor"!=s||!t&&i.call(e,s))&&r.push(s);return r}},1506:(e,t,r)=>{var n=r(4796),a=r(5265),o=r(6805);e.exports=function(e,t){return o(a(e,t,n),e+"")}},1738:e=>{var t=Object.prototype.toString;e.exports=function(e){return t.call(e)}},2007:t=>{"use strict";t.exports=e},2781:(e,t,r)=>{var n=r(1433).Symbol;e.exports=n},2845:e=>{var t=/^(?:0|[1-9]\d*)$/;e.exports=function(e,r){var n=typeof e;return!!(r=null==r?9007199254740991:r)&&("number"==n||"symbol"!=n&&t.test(e))&&e>-1&&e%1==0&&e<r}},2934:e=>{e.exports=function(e){return null!=e&&"object"==typeof e}},3122:e=>{e.exports=function(e){return function(){return e}}},3241:e=>{"use strict";e.exports=t},3330:e=>{e.exports=function(e){return"number"==typeof e&&e>-1&&e%1==0&&e<=9007199254740991}},3685:(e,t,r)=>{e=r.nmd(e);var n=r(5380),a=t&&!t.nodeType&&t,o=a&&e&&!e.nodeType&&e,i=o&&o.exports===a&&n.process,s=function(){try{var e=o&&o.require&&o.require("util").types;return e||i&&i.binding&&i.binding("util")}catch(e){}}();e.exports=s},3936:(e,t,r)=>{var n=r(1506),a=r(9316),o=r(6220),i=r(5405),s=Object.prototype,c=s.hasOwnProperty,l=n(function(e,t){e=Object(e);var r=-1,n=t.length,l=n>2?t[2]:void 0;for(l&&o(t[0],t[1],l)&&(n=1);++r<n;)for(var u=t[r],p=i(u),b=-1,f=p.length;++b<f;){var y=p[b],g=e[y];(void 0===g||a(g,s[y])&&!c.call(e,y))&&(e[y]=u[y])}return e});e.exports=l},3983:e=>{var t=Date.now;e.exports=function(e){var r=0,n=0;return function(){var a=t(),o=16-(a-n);if(n=a,o>0){if(++r>=800)return arguments[0]}else r=0;return e.apply(void 0,arguments)}}},4796:e=>{e.exports=function(e){return e}},5265:(e,t,r)=>{var n=r(6701),a=Math.max;e.exports=function(e,t,r){return t=a(void 0===t?e.length-1:t,0),function(){for(var o=arguments,i=-1,s=a(o.length-t,0),c=Array(s);++i<s;)c[i]=o[t+i];i=-1;for(var l=Array(t+1);++i<t;)l[i]=o[i];return l[t]=r(c),n(e,this,l)}}},5380:(e,t,r)=>{var n="object"==typeof r.g&&r.g&&r.g.Object===Object&&r.g;e.exports=n},5405:(e,t,r)=>{var n=r(1163),a=r(1491),o=r(8330);e.exports=function(e){return o(e)?n(e,!0):a(e)}},5959:e=>{"use strict";e.exports=r},6204:e=>{e.exports=function(e,t){for(var r=-1,n=Array(e);++r<e;)n[r]=t(r);return n}},6220:(e,t,r)=>{var n=r(9316),a=r(8330),o=r(2845),i=r(8953);e.exports=function(e,t,r){if(!i(r))return!1;var s=typeof t;return!!("number"==s?a(r)&&o(t,r.length):"string"==s&&t in r)&&n(r[t],e)}},6397:e=>{var t=Array.isArray;e.exports=t},6567:(e,t,r)=>{var n=r(8446),a=r(8092),o=r(8953),i=r(1485),s=/^\[object .+?Constructor\]$/,c=Function.prototype,l=Object.prototype,u=c.toString,p=l.hasOwnProperty,b=RegExp("^"+u.call(p).replace(/[\\^$.*+?()[\]{}|]/g,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$");e.exports=function(e){return!(!o(e)||a(e))&&(n(e)?b:s).test(i(e))}},6701:e=>{e.exports=function(e,t,r){switch(r.length){case 0:return e.call(t);case 1:return e.call(t,r[0]);case 2:return e.call(t,r[0],r[1]);case 3:return e.call(t,r[0],r[1],r[2])}return e.apply(t,r)}},6772:e=>{e.exports=function(e,t){return null==e?void 0:e[t]}},6805:(e,t,r)=>{var n=r(7310),a=r(3983)(n);e.exports=a},7129:(e,t,r)=>{var n=r(7148),a=r(3330),o=r(2934),i={};i["[object Float32Array]"]=i["[object Float64Array]"]=i["[object Int8Array]"]=i["[object Int16Array]"]=i["[object Int32Array]"]=i["[object Uint8Array]"]=i["[object Uint8ClampedArray]"]=i["[object Uint16Array]"]=i["[object Uint32Array]"]=!0,i["[object Arguments]"]=i["[object Array]"]=i["[object ArrayBuffer]"]=i["[object Boolean]"]=i["[object DataView]"]=i["[object Date]"]=i["[object Error]"]=i["[object Function]"]=i["[object Map]"]=i["[object Number]"]=i["[object Object]"]=i["[object RegExp]"]=i["[object Set]"]=i["[object String]"]=i["[object WeakMap]"]=!1,e.exports=function(e){return o(e)&&a(e.length)&&!!i[n(e)]}},7148:(e,t,r)=>{var n=r(2781),a=r(7903),o=r(1738),i=n?n.toStringTag:void 0;e.exports=function(e){return null==e?void 0===e?"[object Undefined]":"[object Null]":i&&i in Object(e)?a(e):o(e)}},7310:(e,t,r)=>{var n=r(3122),a=r(8559),o=r(4796),i=a?function(e,t){return a(e,"toString",{configurable:!0,enumerable:!1,value:n(t),writable:!0})}:o;e.exports=i},7499:e=>{var t=Object.prototype;e.exports=function(e){var r=e&&e.constructor;return e===("function"==typeof r&&r.prototype||t)}},7781:e=>{"use strict";e.exports=n},7903:(e,t,r)=>{var n=r(2781),a=Object.prototype,o=a.hasOwnProperty,i=a.toString,s=n?n.toStringTag:void 0;e.exports=function(e){var t=o.call(e,s),r=e[s];try{e[s]=void 0;var n=!0}catch(e){}var a=i.call(e);return n&&(t?e[s]=r:delete e[s]),a}},7995:(e,t,r)=>{var n=r(7129),a=r(41),o=r(3685),i=o&&o.isTypedArray,s=i?a(i):n;e.exports=s},8092:(e,t,r)=>{var n,a=r(8109),o=(n=/[^.]+$/.exec(a&&a.keys&&a.keys.IE_PROTO||""))?"Symbol(src)_1."+n:"";e.exports=function(e){return!!o&&o in e}},8109:(e,t,r)=>{var n=r(1433)["__core-js_shared__"];e.exports=n},8201:e=>{e.exports=function(e){var t=[];if(null!=e)for(var r in Object(e))t.push(r);return t}},8330:(e,t,r)=>{var n=r(8446),a=r(3330);e.exports=function(e){return null!=e&&a(e.length)&&!n(e)}},8446:(e,t,r)=>{var n=r(7148),a=r(8953);e.exports=function(e){if(!a(e))return!1;var t=n(e);return"[object Function]"==t||"[object GeneratorFunction]"==t||"[object AsyncFunction]"==t||"[object Proxy]"==t}},8531:e=>{"use strict";e.exports=a},8559:(e,t,r)=>{var n=r(9138),a=function(){try{var e=n(Object,"defineProperty");return e({},"",{}),e}catch(e){}}();e.exports=a},8953:e=>{e.exports=function(e){var t=typeof e;return null!=e&&("object"==t||"function"==t)}},9138:(e,t,r)=>{var n=r(6567),a=r(6772);e.exports=function(e,t){var r=a(e,t);return n(r)?r:void 0}},9250:(e,t,r)=>{var n=r(7148),a=r(2934);e.exports=function(e){return a(e)&&"[object Arguments]"==n(e)}},9316:e=>{e.exports=function(e,t){return e===t||e!=e&&t!=t}}},i={};function s(e){var t=i[e];if(void 0!==t)return t.exports;var r=i[e]={id:e,loaded:!1,exports:{}};return o[e](r,r.exports,s),r.loaded=!0,r.exports}s.n=e=>{var t=e&&e.__esModule?()=>e.default:()=>e;return s.d(t,{a:t}),t},s.d=(e,t)=>{for(var r in t)s.o(t,r)&&!s.o(e,r)&&Object.defineProperty(e,r,{enumerable:!0,get:t[r]})},s.g=function(){if("object"==typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(e){if("object"==typeof window)return window}}(),s.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t),s.r=e=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},s.nmd=e=>(e.paths=[],e.children||(e.children=[]),e);var c={};return(()=>{"use strict";s.r(c),s.d(c,{plugin:()=>pe});var e=s(7781),t=s(8531),r=s(3241),n=function(e){return e.UpstreamBytes="upstream_bytes",e.TotalBytes="total_bytes",e.SentBytes="sent_bytes",e.ShieldBytes="shield_bytes",e.Requests="requests",e.Responses2xx="responses_2xx",e.Responses3xx="responses_3xx",e.Responses4xx="responses_4xx",e.Responses5xx="responses_5xx",e.CacheHitRequestsRatio="cache_hit_requests_ratio",e.CacheHitTrafficRatio="cache_hit_traffic_ratio",e.ShieldTrafficRatio="shield_traffic_ratio",e.ImageProcessed="image_processed",e.RequestWafPassed="requests_waf_passed",e}({}),a=function(e){return e.Bandwidth="bandwidth",e}({}),o=function(e){return e.Resource="resource",e.Region="region",e.VHost="vhost",e.Client="client",e.Country="country",e.DC="dc",e}({}),i=function(e){return e.FiveMinutes="5m",e.FifteenMinutes="15m",e.OneHour="1h",e.OneDay="1d",e}({}),l=function(e){return e.Number="none",e.Bandwidth="bit/sec",e.Bytes="bytes",e.Percent="none",e}({}),u=function(e){return e.Resource="resource",e.Client="client",e.Vhost="vhost",e.Region="region",e.Country="country",e.Datacenter="datacenter",e}({});function p(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}class b{}p(b,"MILLISECOND",1e3),p(b,"SECOND",1),p(b,"MINUTE",60*b.SECOND),p(b,"HOUR",60*b.MINUTE),p(b,"DAY",24*b.HOUR);const f=e=>e.filter(y).map(e=>({text:`${e}`})),y=(e,t,r)=>r.indexOf(e)===t,g=["na","eu","cis","asia","au","latam","me"],d=["Afghanistan","Albania","Algeria","American Samoa","Andorra","Angola","Anguilla","Antarctica","Antigua and Barbuda","Argentina","Armenia","Aruba","Australia","Austria","Azerbaijan","Bahamas","Bahrain","Bangladesh","Barbados","Belarus","Belgium","Belize","Benin","Bermuda","Bhutan","Bolivia","Bonaire,Sint Eustatius and Saba","Bosnia and Herzegovina","Botswana","Bouvet Island","Brazil","British Indian Ocean Territory","Brunei","Bulgaria","Burkina Faso","Burundi","Cabo Verde","Cambodia","Cameroon","Canada","Cayman Islands","Central African Republic","Chad","Chile","China","Christmas Island","Cocos (Keeling) Islands","Colombia","Comoros","Democratic Republic of the Congo","Republic of the Congo","Cook Islands","Costa Rica","Côte d'Ivoire","Croatia","Cuba","Curaçao","Cyprus","Czech Republic","Denmark","Djibouti","Dominica","Dominican Republic","Ecuador","Egypt","El Salvador","Equatorial Guinea","Eritrea","Estonia","Eswatini","Ethiopia","Falkland Islands","Faroe Islands","Fiji","Finland","France","French Guiana","French Polynesia","French Southern Territories","Gabon","Gambia","Georgia","Germany","Ghana","Gibraltar","Greece","Greenland","Grenada","Guadeloupe","Guam","Guatemala","Guernsey","Guinea","Guinea-Bissau","Guyana","Haiti","Heard Island and McDonald Islands","Vatican","Honduras","Hong Kong","Hungary","Iceland","India","Indonesia","Iran","Iraq","Ireland","Isle of Man","Israel","Italy","Jamaica","Japan","Jersey","Jordan","Kazakhstan","Kenya","Kiribati","North Korea","South Korea","Kyrgyzstan","Laos","Latvia","Lebanon","Lesotho","Liberia","Libya","Liechtenstein","Lithuania","Luxembourg","Macao","Madagascar","Malawi","Malaysia","Maldives","Mali","Malta","Marshall Islands","Martinique","Mauritania","Mauritius","Mayotte","Mexico","Micronesia","Moldova","Monaco","Mongolia","Montenegro","Montserrat","Morocco","Mozambique","Myanmar","Namibia","Nauru","Nepal","Netherlands","New Caledonia","New Zealand","Nicaragua","Niger","Nigeria","Niue","Norfolk Island","North Macedonia","Northern Mariana Islands","Norway","Oman","Pakistan","Palau","Palestine","Panama","Papua New Guinea","Paraguay","Peru","Philippines","Pitcairn","Poland","Portugal","Puerto Rico","Qatar","Réunion","Romania","Russian Federation","Rwanda","Saint Barthélemy","Saint Helena, Ascension and Tristan da Cunha","Saint Kitts and Nevis","Saint Lucia","Saint Martin","Saint Pierre and Miquelon","Saint Vincent and the Grenadines","Samoa","San Marino","Sao Tome and Principe","Saudi Arabia","Senegal","Serbia","Seychelles","Sierra Leone","Singapore","Sint Maarten","Slovakia","Slovenia","Solomon Islands","Somalia","South Africa","South Georgia and the South Sandwich Islands","South Sudan","Spain","Sri Lanka","Sudan","Suriname","Svalbard and Jan Mayen","Sweden","Switzerland","Syria","Taiwan","Tajikistan","Tanzania","Thailand","Timor-Leste","Togo","Tokelau","Tonga","Trinidad and Tobago","Tunisia","Turkey","Turkmenistan","Turks and Caicos Islands","Tuvalu","Uganda","Ukraine","United Arab Emirates","United Kingdom","United States Minor Outlying Islands","United States","Uruguay","Uzbekistan","Vanuatu","Venezuela","Vietnam","British Virgin Islands","United States Virgin Islands","Wallis and Futuna","Western Sahara","Yemen","Zambia","Zimbabwe","Kuwait"];function h(e,t,r,n,a,o,i){try{var s=e[o](i),c=s.value}catch(e){return void r(e)}s.done?t(c):Promise.resolve(c).then(n,a)}function m(e){return function(){var t=this,r=arguments;return new Promise(function(n,a){var o=e.apply(t,r);function i(e){h(o,n,a,i,s,"next",e)}function s(e){h(o,n,a,i,s,"throw",e)}i(void 0)})}}class O extends t.DataSourceWithBackend{metricFindQuery(e){return m(function*(){if(!e.selector)return[];const t=e.selector.value;if(t===u.Client||t===u.Resource||t===u.Vhost){const e=yield this.getAllGCCdnResources();switch(t){case u.Vhost:return f(e.map(e=>e.cname));case u.Resource:return f(e.map(e=>e.id));case u.Client:return f(e.map(e=>e.client))}}else{if(t===u.Region)return f(g);if(t===u.Country)return f(d)}return[]}).call(this)}getAllGCCdnResources(){return m(function*(){const e=(e,r=0)=>(0,t.getBackendSrv)().datasourceRequest({method:"GET",url:`api/datasources/${this.id}/resources`,responseType:"json",showErrorAlert:!0,params:{fields:"id,cname,client",deleted:!0,limit:e,offset:r}}).catch(e=>{if(401===e.status)throw new Error("Unauthorized: Invalid API Key. Please check your datasource configuration.");throw e}),n=1e3,a=yield e(n),o=a.data.count;if(o<=n)return a.data.results;{const t=(0,r.range)(n,o,n).map(t=>e(n,t));return(yield Promise.all(t)).reduce((e,t)=>e.concat(t.data.results),a.data.results)}}).call(this)}filterQuery(e){var t;return!e.hide&&!!(null===(t=e.metric)||void 0===t?void 0:t.value)}constructor(e){var t,r,n;super(e),n=void 0,(r="id")in(t=this)?Object.defineProperty(t,r,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[r]=n,this.id=e.id}}var v=s(5959),j=s.n(v),P=s(2007),w=function(e){return e.APIKey="APIKey",e.Bearer="Bearer",e}({});const S=e=>0===e.length?"":(e=>{try{return e.split(" ")[0]in w}catch(e){return!0}})(e)?e:(e=>{try{return"JWT"===JSON.parse(atob(e.split(".")[0])).typ}catch(e){return!1}})(e)?`Bearer ${e}`:`APIKey ${e}`;function x(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function C(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{},n=Object.keys(r);"function"==typeof Object.getOwnPropertySymbols&&(n=n.concat(Object.getOwnPropertySymbols(r).filter(function(e){return Object.getOwnPropertyDescriptor(r,e).enumerable}))),n.forEach(function(t){x(e,t,r[t])})}return e}function R(e,t){return t=null!=t?t:{},Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):function(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),r.push.apply(r,n)}return r}(Object(t)).forEach(function(r){Object.defineProperty(e,r,Object.getOwnPropertyDescriptor(t,r))}),e}const{FormField:E,SecretFormField:M}=P.LegacyForms;class D extends v.PureComponent{render(){const{options:e}=this.props,{apiKey:t,apiUrl:r}=this.state,{secureJsonFields:n}=e,a=n&&n.apiKey;return j().createElement(j().Fragment,null,j().createElement(P.Legend,null,"HTTP"),j().createElement("div",{className:"gf-form-group"},j().createElement(E,{label:"URL",labelWidth:8,inputWidth:20,placeholder:"API base url",value:r,onChange:this.onApiUrlChange,onBlur:this.updateApiUrl,required:!0})),j().createElement("div",{className:"gf-form-group"},j().createElement(M,{isConfigured:a,label:"API key",placeholder:"Secure field",labelWidth:8,inputWidth:20,value:t,onChange:this.onApiKeyChange,onBlur:this.updateApiKey,onReset:this.onResetApiKey})),j().createElement("div",{className:"gf-form-group"},j().createElement(P.Alert,{severity:"info",title:"How to create a API token?"},j().createElement("a",{href:"https://gcore.com/docs/account-settings/create-use-or-delete-a-permanent-api-token",target:"_blank",rel:"noreferrer"},"https://gcore.com/docs/account-settings/create-use-or-delete-a-permanent-api-token"))))}constructor(e){super(e),x(this,"onApiUrlChange",e=>{this.setState({apiUrl:e.target.value})}),x(this,"updateApiUrl",()=>{const{onOptionsChange:e,options:t}=this.props,r=(e=>e.endsWith("/")?e.slice(0,-1):e)((e=>e.replace(/^https?:\/\//,""))(this.state.apiUrl.trim()));e(R(C({},t),{jsonData:{apiUrl:r}}))}),x(this,"onApiKeyChange",e=>{this.setState({apiKey:e.target.value})}),x(this,"updateApiKey",()=>{const{onOptionsChange:e,options:t}=this.props,r=S(this.state.apiKey.trim());e(R(C({},t),{secureJsonData:{apiKey:r}}))}),x(this,"onResetApiKey",()=>{const{onOptionsChange:e,options:t}=this.props;e(R(C({},t),{secureJsonFields:R(C({},t.secureJsonFields),{apiKey:!1}),secureJsonData:R(C({},t.secureJsonData),{apiKey:""})}))});const t=e.options.secureJsonData||{},r=e.options.jsonData||{};this.state={apiKey:t.apiKey||"",apiUrl:r.apiUrl||""}}}var A=s(3936),B=s.n(A);function T(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}const F={[a.Bandwidth]:{originalMetric:n.TotalBytes,label:"Bandwidth",unit:l.Bandwidth},[n.TotalBytes]:{originalMetric:n.TotalBytes,label:"Total Traffic",unit:l.Bytes},[n.UpstreamBytes]:{originalMetric:n.UpstreamBytes,label:"Origin Traffic",unit:l.Bytes},[n.SentBytes]:{originalMetric:n.SentBytes,label:"Edges Traffic",unit:l.Bytes},[n.ShieldBytes]:{originalMetric:n.ShieldBytes,label:"Shield Traffic",unit:l.Bytes},[n.Requests]:{originalMetric:n.Requests,label:"Total Requests",unit:l.Number},[n.RequestWafPassed]:{originalMetric:n.RequestWafPassed,label:"WAF requests",unit:l.Number},[n.Responses2xx]:{originalMetric:n.Responses2xx,label:"2xx Responses",unit:l.Number},[n.Responses3xx]:{originalMetric:n.Responses3xx,label:"3xx Responses",unit:l.Number},[n.Responses4xx]:{originalMetric:n.Responses4xx,label:"4xx Responses",unit:l.Number},[n.Responses5xx]:{originalMetric:n.Responses5xx,label:"5xx Responses",unit:l.Number},[n.ImageProcessed]:{originalMetric:n.ImageProcessed,label:"Image optimization",unit:l.Number},[n.CacheHitRequestsRatio]:{originalMetric:n.CacheHitRequestsRatio,label:"Cache Hit Ratio",unit:l.Percent},[n.CacheHitTrafficRatio]:{originalMetric:n.CacheHitTrafficRatio,label:"Byte Cache Hit Ratio",unit:l.Percent},[n.ShieldTrafficRatio]:{originalMetric:n.ShieldTrafficRatio,label:"Shield Traffic Ratio",unit:l.Percent}};function I(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function N(e,t){return t=null!=t?t:{},Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):function(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),r.push.apply(r,n)}return r}(Object(t)).forEach(function(r){Object.defineProperty(e,r,Object.getOwnPropertyDescriptor(t,r))}),e}const k=e=>j().createElement(P.Select,N(function(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{},n=Object.keys(r);"function"==typeof Object.getOwnPropertySymbols&&(n=n.concat(Object.getOwnPropertySymbols(r).filter(function(e){return Object.getOwnPropertyDescriptor(r,e).enumerable}))),n.forEach(function(t){I(e,t,r[t])})}return e}({},e),{options:Object.entries(F).map(([e,{label:t}])=>({value:e,label:t}))}));function U(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}const q={[i.FiveMinutes]:{label:"5m",seconds:5*b.MINUTE},[i.FifteenMinutes]:{label:"15m",seconds:15*b.MINUTE},[i.OneHour]:{label:"1h",seconds:b.HOUR},[i.OneDay]:{label:"1d",seconds:b.DAY}};function G(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function _(e,t){return t=null!=t?t:{},Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):function(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),r.push.apply(r,n)}return r}(Object(t)).forEach(function(r){Object.defineProperty(e,r,Object.getOwnPropertyDescriptor(t,r))}),e}const K=e=>j().createElement(P.Select,_(function(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{},n=Object.keys(r);"function"==typeof Object.getOwnPropertySymbols&&(n=n.concat(Object.getOwnPropertySymbols(r).filter(function(e){return Object.getOwnPropertyDescriptor(r,e).enumerable}))),n.forEach(function(t){G(e,t,r[t])})}return e}({},e),{options:Object.entries(q).map(([e,{label:t}])=>({value:e,label:t}))}));function H(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}const V={[o.Client]:{label:"Client"},[o.VHost]:{label:"Vhost"},[o.Resource]:{label:"Resource"},[o.Region]:{label:"Region"},[o.Country]:{label:"Country"},[o.DC]:{label:"Datacenter"}};function L(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function Q(e,t){return t=null!=t?t:{},Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):function(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),r.push.apply(r,n)}return r}(Object(t)).forEach(function(r){Object.defineProperty(e,r,Object.getOwnPropertyDescriptor(t,r))}),e}const W=e=>j().createElement(P.MultiSelect,Q(function(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{},n=Object.keys(r);"function"==typeof Object.getOwnPropertySymbols&&(n=n.concat(Object.getOwnPropertySymbols(r).filter(function(e){return Object.getOwnPropertyDescriptor(r,e).enumerable}))),n.forEach(function(t){L(e,t,r[t])})}return e}({},e),{options:Object.entries(V).map(([e,{label:t}])=>({value:e,label:t}))}));function z(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function J(e,t){return t=null!=t?t:{},Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):function(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),r.push.apply(r,n)}return r}(Object(t)).forEach(function(r){Object.defineProperty(e,r,Object.getOwnPropertyDescriptor(t,r))}),e}function $(e,t){if(null==e)return{};var r,n,a=function(e,t){if(null==e)return{};var r,n,a={},o=Object.keys(e);for(n=0;n<o.length;n++)r=o[n],t.indexOf(r)>=0||(a[r]=e[r]);return a}(e,t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);for(n=0;n<o.length;n++)r=o[n],t.indexOf(r)>=0||Object.prototype.propertyIsEnumerable.call(e,r)&&(a[r]=e[r])}return a}const{FormField:Y}=P.LegacyForms,Z=e=>{const{onChange:t}=e,n=$(e,["onChange"]),[a,o]=(0,v.useState)(n.value),i=(0,v.useRef)((0,r.debounce)(e=>t(e),n.debounce||500)).current;return j().createElement(Y,J(function(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{},n=Object.keys(r);"function"==typeof Object.getOwnPropertySymbols&&(n=n.concat(Object.getOwnPropertySymbols(r).filter(function(e){return Object.getOwnPropertyDescriptor(r,e).enumerable}))),n.forEach(function(t){z(e,t,r[t])})}return e}({},n),{value:a,onChange:e=>{e.persist(),o(e.target.value),i(e)}}))},X={vhosts:"",clients:"",resources:"",metric:(re=n.TotalBytes,function(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{},n=Object.keys(r);"function"==typeof Object.getOwnPropertySymbols&&(n=n.concat(Object.getOwnPropertySymbols(r).filter(function(e){return Object.getOwnPropertyDescriptor(r,e).enumerable}))),n.forEach(function(t){T(e,t,r[t])})}return e}({value:re},F[re])),grouping:[(te=o.Resource,function(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{},n=Object.keys(r);"function"==typeof Object.getOwnPropertySymbols&&(n=n.concat(Object.getOwnPropertySymbols(r).filter(function(e){return Object.getOwnPropertyDescriptor(r,e).enumerable}))),n.forEach(function(t){H(e,t,r[t])})}return e}({value:te},V[te]))],granularity:(ee=i.OneHour,function(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{},n=Object.keys(r);"function"==typeof Object.getOwnPropertySymbols&&(n=n.concat(Object.getOwnPropertySymbols(r).filter(function(e){return Object.getOwnPropertyDescriptor(r,e).enumerable}))),n.forEach(function(t){U(e,t,r[t])})}return e}({value:ee},q[ee]))};var ee,te,re;const ne={selector:{value:u.Resource,label:"resourceID"}};function ae(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function oe(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{},n=Object.keys(r);"function"==typeof Object.getOwnPropertySymbols&&(n=n.concat(Object.getOwnPropertySymbols(r).filter(function(e){return Object.getOwnPropertyDescriptor(r,e).enumerable}))),n.forEach(function(t){ae(e,t,r[t])})}return e}function ie(e,t){return t=null!=t?t:{},Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):function(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),r.push.apply(r,n)}return r}(Object(t)).forEach(function(r){Object.defineProperty(e,r,Object.getOwnPropertyDescriptor(t,r))}),e}const{FormField:se}=P.LegacyForms;class ce extends v.PureComponent{render(){const e=B()(this.props.query,X),{metric:t,legendFormat:r,grouping:n,countries:a,granularity:o,regions:i,vhosts:s,resources:c,clients:l}=e;return j().createElement(j().Fragment,null,j().createElement("div",null,j().createElement("div",{className:"section",style:{marginRight:"27px"}},j().createElement("label",{className:"gf-form-group-label"},"Query Props"),j().createElement("div",{className:"gf-form"},j().createElement(se,{label:"Metric",inputEl:j().createElement(k,{width:20,isSearchable:!0,maxVisibleValues:20,minMenuHeight:45,menuPlacement:"bottom",onChange:this.onMetricChange,value:t})})),j().createElement("div",{className:"gf-form"},j().createElement(se,{label:"Granularity",tooltip:"Time series granularity",inputEl:j().createElement(K,{width:20,maxVisibleValues:4,minMenuHeight:25,menuPlacement:"bottom",onChange:this.onGranularityChange,value:o})})),j().createElement("div",{className:"gf-form"},j().createElement(se,{label:"Group By",tooltip:"Fields used for grouping",inputEl:j().createElement(W,{width:20,isSearchable:!0,maxVisibleValues:20,minMenuHeight:35,menuPlacement:"bottom",onChange:this.onGroupingChange,value:n})}))),j().createElement("div",{className:"section",style:{marginRight:"27px"}},j().createElement("label",{className:"gf-form-group-label"},"Filters (comma separated)"),j().createElement("div",{className:"gf-form"},j().createElement(Z,{width:8,value:s,onChange:this.onVhostsChange,label:"Vhosts",tooltip:"Filter by vhost",type:"text"})),j().createElement("div",{className:"gf-form"},j().createElement(Z,{width:8,value:c,onChange:this.onResourcesChange,label:"Resources",tooltip:"Filter by resource id",type:"text"})),j().createElement("div",{className:"gf-form"},j().createElement(Z,{width:8,value:l,onChange:this.onClientsChange,label:"Clients",tooltip:"Filter by client id",type:"text"})),j().createElement("div",{className:"gf-form"},j().createElement(Z,{width:8,value:i,onChange:this.onRegionChange,label:"Regions",tooltip:"Filter by region",type:"text"})),j().createElement("div",{className:"gf-form"},j().createElement(Z,{width:8,value:a,onChange:this.onCountryChange,label:"Countries",tooltip:"Filter by country",type:"text"})))),j().createElement("div",null,j().createElement("div",{className:"gf-form"},j().createElement(Z,{inputWidth:30,value:r,onChange:this.onLegendFormatChange,label:"Legend",placeholder:"legend format",tooltip:"Controls the name of the time series, using name or pattern. For example {{resource}} will be replaced with label value for the label resource.",type:"text"}))))}constructor(...e){super(...e),ae(this,"onMetricChange",e=>{const{onChange:t,query:r,onRunQuery:n}=this.props;t(ie(oe({},r),{metric:e})),n()}),ae(this,"onGroupingChange",e=>{const{onChange:t,query:r,onRunQuery:n}=this.props;t(ie(oe({},r),{grouping:e})),n()}),ae(this,"onGranularityChange",e=>{const{onChange:t,query:r,onRunQuery:n}=this.props;t(ie(oe({},r),{granularity:e})),n()}),ae(this,"onVhostsChange",e=>{const{onChange:t,query:r,onRunQuery:n}=this.props;t(ie(oe({},r),{vhosts:e.target.value})),n()}),ae(this,"onResourcesChange",e=>{const{onChange:t,query:r,onRunQuery:n}=this.props;t(ie(oe({},r),{resources:e.target.value})),n()}),ae(this,"onClientsChange",e=>{const{onChange:t,query:r,onRunQuery:n}=this.props;t(ie(oe({},r),{clients:e.target.value})),n()}),ae(this,"onRegionChange",e=>{const{onChange:t,query:r,onRunQuery:n}=this.props;t(ie(oe({},r),{regions:e.target.value})),n()}),ae(this,"onCountryChange",e=>{const{onChange:t,query:r,onRunQuery:n}=this.props;t(ie(oe({},r),{countries:e.target.value})),n()}),ae(this,"onLegendFormatChange",e=>{const{onChange:t,query:r,onRunQuery:n}=this.props;t(ie(oe({},r),{legendFormat:e.target.value})),n()})}}function le(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function ue(e,t){return t=null!=t?t:{},Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):function(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),r.push.apply(r,n)}return r}(Object(t)).forEach(function(r){Object.defineProperty(e,r,Object.getOwnPropertyDescriptor(t,r))}),e}const pe=new e.DataSourcePlugin(O).setConfigEditor(D).setQueryEditor(ce).setVariableQueryEditor(({onChange:e,query:t})=>{const r=B()(t,ne),[n,a]=(0,v.useState)(r);return j().createElement("div",{className:"gf-form"},j().createElement("span",{className:"gf-form-label width-10"},"Values for"),j().createElement(P.Select,{width:16,maxVisibleValues:20,minMenuHeight:45,menuPlacement:"bottom",onBlur:()=>{e(n,`${n.selector.label}`)},onChange:e=>a(ue(function(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{},n=Object.keys(r);"function"==typeof Object.getOwnPropertySymbols&&(n=n.concat(Object.getOwnPropertySymbols(r).filter(function(e){return Object.getOwnPropertyDescriptor(r,e).enumerable}))),n.forEach(function(t){le(e,t,r[t])})}return e}({},n),{selector:e})),value:n.selector,options:[{value:u.Resource,label:"resourceID"},{value:u.Vhost,label:"vhost"},{value:u.Client,label:"client"},{value:u.Country,label:"country"},{value:u.Region,label:"region"}]}))})})(),c})());
//# sourceMappingURL=module.js.map